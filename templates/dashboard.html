<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
    <script>
        const portfolioData = {{ data | safe }};
    </script>
    
    <div class="navbar">
        <h1>ðŸ“Š Portfolio Dashboard</h1>
        <p>Real-time Analytics â€¢ Risk Assessment â€¢ Performance Tracking</p>
    </div>
    
    <div class="container">
        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab('overview')">Overview</button>
            <button class="tab-btn" onclick="switchTab('risk')">Risk Analysis</button>
            <button class="tab-btn" onclick="switchTab('holdings')">Holdings</button>
            <button class="tab-btn" onclick="switchTab('transactions')">Transactions</button>
        </div>
        
        <!-- OVERVIEW TAB -->
        <div id="overview" class="tab-content active">
            <div class="kpi-grid">
                <div class="kpi-card positive">
                    <div class="kpi-label">Portfolio Value</div>
                    <div class="kpi-value" id="totalValueKPI">$0</div>
                    <div class="kpi-change">Current Market Value</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-label">Total Invested</div>
                    <div class="kpi-value" id="investedKPI">$0</div>
                    <div class="kpi-change">Cost Basis</div>
                </div>
                <div class="kpi-card positive">
                    <div class="kpi-label">Total Gain/Loss</div>
                    <div class="kpi-value" id="gainKPI">$0</div>
                    <div class="kpi-change" id="gainPctKPI">+0%</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-label">Sharpe Ratio</div>
                    <div class="kpi-value" id="sharpeKPI">0.00</div>
                    <div class="kpi-change">Risk-Adjusted Return</div>
                </div>
            </div>
            
            <div class="chart-grid">
                <div class="card">
                    <div class="card-title">Portfolio Allocation</div>
                    <canvas id="allocationChart"></canvas>
                </div>
                <div class="card">
                    <div class="card-title">Value Trend</div>
                    <canvas id="valueChart"></canvas>
                </div>
            </div>
        </div>
        
        <!-- RISK TAB -->
        <div id="risk" class="tab-content">
            <div class="kpi-grid">
                <div class="kpi-card warning">
                    <div class="kpi-label">Annual Volatility</div>
                    <div class="kpi-value" id="volatilityKPI">0%</div>
                    <div class="kpi-change">Price Fluctuation</div>
                </div>
                <div class="kpi-card positive">
                    <div class="kpi-label">Sharpe Ratio</div>
                    <div class="kpi-value" id="sharpe2KPI">0.00</div>
                    <div class="kpi-change">Risk-Adjusted Score</div>
                </div>
                <div class="kpi-card warning">
                    <div class="kpi-label">Max Drawdown</div>
                    <div class="kpi-value" id="drawdownKPI">-0%</div>
                    <div class="kpi-change">Worst Loss from Peak</div>
                </div>
                <div class="kpi-card positive">
                    <div class="kpi-label">YTD Return</div>
                    <div class="kpi-value" id="returnKPI">+0%</div>
                    <div class="kpi-change">Year-to-Date Performance</div>
                </div>
            </div>
            
            <div class="chart-grid">
                <div class="card">
                    <div class="card-title">Volatility Trend</div>
                    <canvas id="volatilityChart"></canvas>
                </div>
                <div class="card">
                    <div class="card-title">Return Performance</div>
                    <canvas id="returnChart"></canvas>
                </div>
            </div>
        </div>
        
        <!-- HOLDINGS TAB -->
        <div id="holdings" class="tab-content">
            <div class="table-container">
                <table id="holdingsTable">
                    <thead>
                        <tr>
                            <th>Ticker</th>
                            <th>Company</th>
                            <th>Shares</th>
                            <th>Avg Cost</th>
                            <th>Current Price</th>
                            <th>Current Value</th>
                            <th>Gain/Loss</th>
                            <th>Return %</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
            
            <div class="chart-grid">
                <div class="card">
                    <div class="card-title">Performance by Stock</div>
                    <canvas id="holdingPerformanceChart"></canvas>
                </div>
                <div class="card">
                    <div class="card-title">Sector Allocation</div>
                    <canvas id="sectorChart"></canvas>
                </div>
            </div>
        </div>
        
        <!-- TRANSACTIONS TAB -->
        <div id="transactions" class="tab-content">
            <div class="table-container">
                <table id="transactionsTable">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Ticker</th>
                            <th>Action</th>
                            <th>Shares</th>
                            <th>Price</th>
                            <th>Total Value</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
            
            <div class="chart-grid">
                <div class="card">
                    <div class="card-title">Transaction Activity</div>
                    <canvas id="activityChart"></canvas>
                </div>
            </div>
        </div>
    </div>
    
    <script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
</body>
</html>
